---
description: Correct build and terminal commands—avoid pipes that kill long-running processes
alwaysApply: true
---

# Build and Terminal Commands

## CRITICAL: NEVER pipe build output to line limiters

**These commands KILL the build** and cause "cancelled" or "spawn EPERM" errors:

❌ BAD (kills build after ~80 lines):
```powershell
npm run build 2>&1 | Select-Object -First 80
npm run build 2>&1 | Select-Object -First 100
```
```bash
npm run build 2>&1 | head -80
```

**Why:** The consumer (`Select-Object` / `head`) exits after N lines → closes the pipe → npm receives broken pipe → build is killed. This causes repetitive build failures.

## Correct commands (use these instead)

✅ **Run build** (default is now safe-build—live output + log, never killed by pipes):
```powershell
npm run build
```

✅ **PWA build** (generates service worker for offline app shell - use for deployment):
```powershell
npm run build:pwa
```

✅ **Use safe build script** (recommended - live output + log file):
```powershell
npm run build:safe
```

✅ **Quiet build** (log file only, no terminal output):
```powershell
npm run build:quiet
```

✅ **Capture to file** (build runs to completion):
```powershell
cd c:\Users\Faycel\Documents\dzd-oc; npm run build 2>&1 | Tee-Object -FilePath build.log
```

✅ **Redirect to file** (no live output):
```powershell
cd c:\Users\Faycel\Documents\dzd-oc; npm run build > build.log 2>&1
```

## Need to see only last N lines?

**Use `npm run build:tail`** instead of piping to Select-Object:

```powershell
npm run build:tail
# Shows last 100 lines after build completes. Full log in build.log
```

**Why:** Piping to `Select-Object -First 100` KILLS the build. The pipe closes after 100 lines → npm gets broken pipe → build cancelled. Use `build:tail` to get limited output without killing the build.

## Windows PowerShell

- Use `;` not `&&` for chaining: `cd path; npm run build`
- Do NOT use `Select-Object -First N` on any long-running process (build, dev, etc.)
